<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
        <link rel="stylesheet" href="/static/main.css" />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Source+Serif+Pro:wght@400;600&display=swap"
            rel="stylesheet"
        />
        <script src="/static/main.js" defer></script>
        <title>{{config.site_name}}</title>
    </head>

    <body>
        {% match config.clock %} {% when Clock::Hour24 %}
        <header role="banner">
            <div id="clock-container" aria-label="Current time">
                <div
                    id="time"
                    data-format="24hour"
                    aria-live="polite"
                    aria-atomic="true"
                >{{current_time}}</div>
            </div>
        </header>
        {% when Clock::Hour12 %}
        <header role="banner">
            <div id="clock-container" aria-label="Current time">
                <div
                    id="time"
                    data-format="12hour"
                    aria-live="polite"
                    aria-atomic="true"
                >{{current_time}}</div>
            </div>
        </header>
        {% when Clock::None %} {% endmatch %}

        <nav role="navigation" aria-label="Site shortcuts">
            <div class="site-toolbar">
                <button
                    id="site-filters-toggle"
                    class="site-filter-button toolbar-icon-button"
                    type="button"
                    aria-haspopup="true"
                    aria-expanded="false"
                    aria-controls="site-filters-panel"
                    aria-label="Open filters"
                >
                    <svg
                        aria-hidden="true"
                        focusable="false"
                        viewBox="0 0 24 24"
                        width="20"
                        height="20"
                        class="site-filter-icon"
                    >
                        <path
                            d="M4 6h16M7 12h10m-7 6h4"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        />
                    </svg>
                    <span class="sr-only">Open filters</span>
                </button>
            </div>
            <div id="site-filters-overlay" class="site-filters-overlay" hidden>
                <div
                    id="site-filters-panel"
                    class="site-filters-panel"
                    role="dialog"
                    aria-modal="true"
                    aria-labelledby="site-filters-title"
                >
                    <section id="site-filters" aria-label="Search and filter sites">
                        <header class="site-filters-header">
                            <h2 id="site-filters-title">Filter sites</h2>
                            <button
                                id="site-filters-close"
                                type="button"
                                class="site-filter-close-button"
                                aria-label="Close filters"
                            >
                                ×
                            </button>
                        </header>
                        <div class="filter-field">
                            <label class="filter-label" for="site-search">Search sites</label>
                            <div class="filter-input-wrapper">
                                <input
                                    id="site-search"
                                    name="site-search"
                                    type="search"
                                    placeholder="Search bookmarks..."
                                    autocomplete="off"
                                    spellcheck="false"
                                    enterkeyhint="search"
                                    aria-label="Search sites"
                                />
                                <span class="filter-shortcut-hint">Press / to focus</span>
                            </div>
                        </div>
                        <div class="filter-field" id="tag-filter-field">
                            <div class="filter-label">Filter by tag</div>
                            <div
                                id="tag-filter-chips"
                                role="listbox"
                                aria-multiselectable="true"
                                aria-label="Tag filters"
                                tabindex="0"
                            ></div>
                        </div>
                    </section>
                </div>
            </div>
            <p id="site-filter-empty" class="filter-empty-state" role="status" hidden>
                No sites match your search or filters.
            </p>
            <div id="sites">
                {% for site in config.sites %}
                {% include "site_card.html" %}
                {% endfor %}
            </div>
        </nav>
        <button
            id="settings-open-button"
            type="button"
            class="site-filter-button toolbar-icon-button site-settings-link"
            aria-label="Open settings"
            aria-haspopup="dialog"
            aria-controls="settings-modal"
        >
            <svg
                aria-hidden="true"
                focusable="false"
                viewBox="0 0 24 24"
                width="20"
                height="20"
                class="site-filter-icon"
            >
                <path
                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.89 3.31.866 2.42 2.409a1.724 1.724 0 001.065 2.574c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.89 1.543-.866 3.31-2.409 2.42a1.724 1.724 0 00-2.574 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.89-3.31-.866-2.42-2.409a1.724 1.724 0 00-1.065-2.574c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.89-1.543.866-3.31 2.409-2.42.996.575 2.296.05 2.573-1.065z"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="1.5"
                />
                <path
                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="1.5"
                />
            </svg>
            <span class="sr-only">Settings</span>
        </button>

        <div id="settings-modal" class="settings-modal" aria-hidden="true" hidden>
            <div class="settings-modal__overlay" data-settings-close></div>
            <div
                class="settings-modal__panel"
                role="dialog"
                aria-modal="true"
                aria-labelledby="settings-modal-title"
            >
                <header class="settings-modal__header">
                    <div>
                        <p class="settings-modal__eyebrow">Dashboard configuration</p>
                        <h2 id="settings-modal-title">Settings</h2>
                    </div>
                    <button
                        type="button"
                        class="settings-close-button"
                        aria-label="Close settings"
                        data-settings-close
                    >
                        ×
                    </button>
                </header>

                <div class="settings-scroll-area">
                    <div class="settings-toolbar">
                        <button
                            id="site-notification-toggle"
                            class="site-filter-button site-notification-button"
                            type="button"
                            aria-haspopup="false"
                            aria-label="Enable system notifications for site status changes"
                        >
                            <svg
                                aria-hidden="true"
                                focusable="false"
                                viewBox="0 0 24 24"
                                width="20"
                                height="20"
                                class="site-filter-icon"
                            >
                                <path
                                    d="M12 22a2 2 0 002-2H10a2 2 0 002 2zm6-6V11a6 6 0 00-5-5.91V4a1 1 0 10-2 0v1.09A6 6 0 006 11v5l-1 1v1h14v-1l-1-1z"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="1.5"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                />
                            </svg>
                            <span class="notification-button-label">Enable alerts</span>
                        </button>
                    </div>

                    <div
                        id="settings-notification-area"
                        class="settings-notification"
                        role="status"
                        hidden
                    ></div>

                    <section class="global-settings">
                        <h3 class="section-title">Global Settings</h3>
                        <div class="form-group">
                            <label for="settings-site-name">Dashboard Name</label>
                            <input
                                type="text"
                                id="settings-site-name"
                                value="{{config.site_name}}"
                                autocomplete="off"
                            />
                        </div>
                        <div class="form-group">
                            <label for="settings-clock-format">Clock Format</label>
                            <select id="settings-clock-format">
                                <option value="none" {% if config.clock == Clock::None %}selected{% endif %}>
                                    No Clock
                                </option>
                                <option value="24hour" {% if config.clock == Clock::Hour24 %}selected{% endif %}>
                                    24 Hour Format
                                </option>
                                <option value="12hour" {% if config.clock == Clock::Hour12 %}selected{% endif %}>
                                    12 Hour Format
                                </option>
                            </select>
                        </div>
                    </section>

                    <section class="sites-management">
                        <h3 class="section-title">Sites</h3>
                        <div class="form-group">
                            <label for="new-site-name">Add New Site</label>
                            <input
                                type="text"
                                id="new-site-name"
                                placeholder="Site name"
                                autocomplete="off"
                            />
                        </div>
                        <div class="form-group">
                            <label for="new-site-url">URL</label>
                            <input
                                type="text"
                                id="new-site-url"
                                placeholder="https://example.com"
                                autocomplete="off"
                            />
                        </div>
                        <div class="form-group">
                            <label for="new-site-category">Category</label>
                            <input
                                type="text"
                                id="new-site-category"
                                placeholder="Category (e.g., Work)"
                                autocomplete="off"
                            />
                        </div>
                        <div class="form-group">
                            <label for="new-site-tags">Tags</label>
                            <input
                                type="text"
                                id="new-site-tags"
                                placeholder="Tags (comma separated)"
                                autocomplete="off"
                            />
                        </div>
                        <div class="settings-inline-actions">
                            <button type="button" class="btn add-tag-btn" id="add-site-btn">
                                Add Site
                            </button>
                            <p class="settings-helper-text">
                                Tags can be comma separated and edited after creation.
                            </p>
                        </div>

                        <div id="settings-sites-list" class="settings-sites-list" aria-live="polite"></div>
                    </section>
                </div>

                <footer class="settings-modal__footer">
                    <div class="settings-actions">
                        <button type="button" class="btn" id="settings-save-button">
                            Save Settings
                        </button>
                        <button type="button" class="btn btn-secondary" id="settings-reset-button">
                            Reset
                        </button>
                    </div>
                </footer>
            </div>
        </div>

        <script id="initial-config" type="application/json">{{config_json|safe}}</script>
    </body>
</html>
